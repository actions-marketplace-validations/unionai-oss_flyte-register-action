var le=Object.create;var j=Object.defineProperty;var fe=Object.getOwnPropertyDescriptor;var de=Object.getOwnPropertyNames;var pe=Object.getPrototypeOf,me=Object.prototype.hasOwnProperty;var ye=e=>j(e,"__esModule",{value:!0});var S=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var he=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of de(t))!me.call(e,i)&&i!=="default"&&j(e,i,{get:()=>t[i],enumerable:!(r=fe(t,i))||r.enumerable});return e},T=e=>he(ye(j(e!=null?le(pe(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var I=S($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.toCommandValue=void 0;function ve(e){return e==null?"":typeof e=="string"||e instanceof String?e:JSON.stringify(e)}$.toCommandValue=ve});var W=S(d=>{"use strict";var _e=d&&d.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),ge=d&&d.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),we=d&&d.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&_e(t,e,r);return ge(t,e),t};Object.defineProperty(d,"__esModule",{value:!0});d.issue=d.issueCommand=void 0;var be=we(require("os")),x=I();function M(e,t,r){let i=new A(e,t,r);process.stdout.write(i.toString()+be.EOL)}d.issueCommand=M;function Ee(e,t=""){M(e,{},t)}d.issue=Ee;var U="::",A=class{constructor(t,r,i){t||(t="missing.command"),this.command=t,this.properties=r,this.message=i}toString(){let t=U+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let r=!0;for(let i in this.properties)if(this.properties.hasOwnProperty(i)){let o=this.properties[i];o&&(r?r=!1:t+=",",t+=`${i}=${Oe(o)}`)}}return t+=`${U}${Se(this.message)}`,t}};function Se(e){return x.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function Oe(e){return x.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var R=S(_=>{"use strict";var $e=_&&_.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Ie=_&&_.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),G=_&&_.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&$e(t,e,r);return Ie(t,e),t};Object.defineProperty(_,"__esModule",{value:!0});_.issueCommand=void 0;var V=G(require("fs")),Ce=G(require("os")),Ne=I();function je(e,t){let r=process.env[`GITHUB_${e}`];if(!r)throw new Error(`Unable to find environment variable for file command ${e}`);if(!V.existsSync(r))throw new Error(`Missing file at path: ${r}`);V.appendFileSync(r,`${Ne.toCommandValue(t)}${Ce.EOL}`,{encoding:"utf8"})}_.issueCommand=je});var K=S(n=>{"use strict";var Te=n&&n.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),De=n&&n.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),B=n&&n.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Te(t,e,r);return De(t,e),t},Pe=n&&n.__awaiter||function(e,t,r,i){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function f(l){try{y(i.next(l))}catch(h){a(h)}}function E(l){try{y(i.throw(l))}catch(h){a(h)}}function y(l){l.done?s(l.value):o(l.value).then(f,E)}y((i=i.apply(e,t||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});n.getState=n.saveState=n.group=n.endGroup=n.startGroup=n.info=n.warning=n.error=n.debug=n.isDebug=n.setFailed=n.setCommandEcho=n.setOutput=n.getBooleanInput=n.getInput=n.addPath=n.setSecret=n.exportVariable=n.ExitCode=void 0;var v=W(),H=R(),Fe=I(),C=B(require("os")),qe=B(require("path")),L;(function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"})(L=n.ExitCode||(n.ExitCode={}));function xe(e,t){let r=Fe.toCommandValue(t);if(process.env[e]=r,process.env.GITHUB_ENV||""){let o="_GitHubActionsFileCommandDelimeter_",s=`${e}<<${o}${C.EOL}${r}${C.EOL}${o}`;H.issueCommand("ENV",s)}else v.issueCommand("set-env",{name:e},r)}n.exportVariable=xe;function Me(e){v.issueCommand("add-mask",{},e)}n.setSecret=Me;function Ue(e){process.env.GITHUB_PATH||""?H.issueCommand("PATH",e):v.issueCommand("add-path",{},e),process.env.PATH=`${e}${qe.delimiter}${process.env.PATH}`}n.addPath=Ue;function k(e,t){let r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r)throw new Error(`Input required and not supplied: ${e}`);return t&&t.trimWhitespace===!1?r:r.trim()}n.getInput=k;function Ae(e,t){let r=["true","True","TRUE"],i=["false","False","FALSE"],o=k(e,t);if(r.includes(o))return!0;if(i.includes(o))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}n.getBooleanInput=Ae;function We(e,t){process.stdout.write(C.EOL),v.issueCommand("set-output",{name:e},t)}n.setOutput=We;function Ge(e){v.issue("echo",e?"on":"off")}n.setCommandEcho=Ge;function Ve(e){process.exitCode=L.Failure,z(e)}n.setFailed=Ve;function Re(){return process.env.RUNNER_DEBUG==="1"}n.isDebug=Re;function Be(e){v.issueCommand("debug",{},e)}n.debug=Be;function z(e){v.issue("error",e instanceof Error?e.toString():e)}n.error=z;function He(e){v.issue("warning",e instanceof Error?e.toString():e)}n.warning=He;function Le(e){process.stdout.write(e+C.EOL)}n.info=Le;function X(e){v.issue("group",e)}n.startGroup=X;function J(){v.issue("endgroup")}n.endGroup=J;function ke(e,t){return Pe(this,void 0,void 0,function*(){X(e);let r;try{r=yield t()}finally{J()}return r})}n.group=ke;function ze(e,t){v.issueCommand("save-state",{name:e},t)}n.saveState=ze;function Xe(e){return process.env[`STATE_${e}`]||""}n.getState=Xe});var ee=S(c=>{"use strict";var N=c&&c.__awaiter||function(e,t,r,i){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function f(l){try{y(i.next(l))}catch(h){a(h)}}function E(l){try{y(i.throw(l))}catch(h){a(h)}}function y(l){l.done?s(l.value):o(l.value).then(f,E)}y((i=i.apply(e,t||[])).next())})},Y=c&&c.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},p;Object.defineProperty(c,"__esModule",{value:!0});var Je=require("assert"),Ke=Y(require("fs")),O=Y(require("path"));p=Ke.promises,c.chmod=p.chmod,c.copyFile=p.copyFile,c.lstat=p.lstat,c.mkdir=p.mkdir,c.readdir=p.readdir,c.readlink=p.readlink,c.rename=p.rename,c.rmdir=p.rmdir,c.stat=p.stat,c.symlink=p.symlink,c.unlink=p.unlink;c.IS_WINDOWS=process.platform==="win32";function Ye(e){return N(this,void 0,void 0,function*(){try{yield c.stat(e)}catch(t){if(t.code==="ENOENT")return!1;throw t}return!0})}c.exists=Ye;function Ze(e,t=!1){return N(this,void 0,void 0,function*(){return(t?yield c.stat(e):yield c.lstat(e)).isDirectory()})}c.isDirectory=Ze;function Qe(e){if(e=tt(e),!e)throw new Error('isRooted() parameter "p" cannot be empty');return c.IS_WINDOWS?e.startsWith("\\")||/^[A-Z]:/i.test(e):e.startsWith("/")}c.isRooted=Qe;function Z(e,t=1e3,r=1){return N(this,void 0,void 0,function*(){if(Je.ok(e,"a path argument must be provided"),e=O.resolve(e),r>=t)return c.mkdir(e);try{yield c.mkdir(e);return}catch(i){switch(i.code){case"ENOENT":{yield Z(O.dirname(e),t,r+1),yield c.mkdir(e);return}default:{let o;try{o=yield c.stat(e)}catch(s){throw i}if(!o.isDirectory())throw i}}}})}c.mkdirP=Z;function et(e,t){return N(this,void 0,void 0,function*(){let r;try{r=yield c.stat(e)}catch(o){o.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${e}': ${o}`)}if(r&&r.isFile()){if(c.IS_WINDOWS){let o=O.extname(e).toUpperCase();if(t.some(s=>s.toUpperCase()===o))return e}else if(Q(r))return e}let i=e;for(let o of t){e=i+o,r=void 0;try{r=yield c.stat(e)}catch(s){s.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${e}': ${s}`)}if(r&&r.isFile()){if(c.IS_WINDOWS){try{let s=O.dirname(e),a=O.basename(e).toUpperCase();for(let f of yield c.readdir(s))if(a===f.toUpperCase()){e=O.join(s,f);break}}catch(s){console.log(`Unexpected error attempting to determine the actual case of the file '${e}': ${s}`)}return e}else if(Q(r))return e}}return""})}c.tryGetExecutablePath=et;function tt(e){return e=e||"",c.IS_WINDOWS?(e=e.replace(/\//g,"\\"),e.replace(/\\\\+/g,"\\")):e.replace(/\/\/+/g,"/")}function Q(e){return(e.mode&1)>0||(e.mode&8)>0&&e.gid===process.getgid()||(e.mode&64)>0&&e.uid===process.getuid()}});var se=S(m=>{"use strict";var b=m&&m.__awaiter||function(e,t,r,i){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function f(l){try{y(i.next(l))}catch(h){a(h)}}function E(l){try{y(i.throw(l))}catch(h){a(h)}}function y(l){l.done?s(l.value):o(l.value).then(f,E)}y((i=i.apply(e,t||[])).next())})},D=m&&m.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(m,"__esModule",{value:!0});var rt=D(require("child_process")),g=D(require("path")),it=require("util"),u=D(ee()),P=it.promisify(rt.exec);function nt(e,t,r={}){return b(this,void 0,void 0,function*(){let{force:i,recursive:o}=st(r),s=(yield u.exists(t))?yield u.stat(t):null;if(s&&s.isFile()&&!i)return;let a=s&&s.isDirectory()?g.join(t,g.basename(e)):t;if(!(yield u.exists(e)))throw new Error(`no such file or directory: ${e}`);if((yield u.stat(e)).isDirectory())if(o)yield ne(e,a,0,i);else throw new Error(`Failed to copy. ${e} is a directory, but tried to copy without recursive flag.`);else{if(g.relative(e,a)==="")throw new Error(`'${a}' and '${e}' are the same file`);yield oe(e,a,i)}})}m.cp=nt;function ot(e,t,r={}){return b(this,void 0,void 0,function*(){if(yield u.exists(t)){let i=!0;if((yield u.isDirectory(t))&&(t=g.join(t,g.basename(e)),i=yield u.exists(t)),i)if(r.force==null||r.force)yield te(t);else throw new Error("Destination already exists")}yield F(g.dirname(t)),yield u.rename(e,t)})}m.mv=ot;function te(e){return b(this,void 0,void 0,function*(){if(u.IS_WINDOWS){try{(yield u.isDirectory(e,!0))?yield P(`rd /s /q "${e}"`):yield P(`del /f /a "${e}"`)}catch(t){if(t.code!=="ENOENT")throw t}try{yield u.unlink(e)}catch(t){if(t.code!=="ENOENT")throw t}}else{let t=!1;try{t=yield u.isDirectory(e)}catch(r){if(r.code!=="ENOENT")throw r;return}t?yield P(`rm -rf "${e}"`):yield u.unlink(e)}})}m.rmRF=te;function F(e){return b(this,void 0,void 0,function*(){yield u.mkdirP(e)})}m.mkdirP=F;function re(e,t){return b(this,void 0,void 0,function*(){if(!e)throw new Error("parameter 'tool' is required");if(t){let i=yield re(e,!1);if(!i)throw u.IS_WINDOWS?new Error(`Unable to locate executable file: ${e}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also verify the file has a valid extension for an executable file.`):new Error(`Unable to locate executable file: ${e}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also check the file mode to verify the file is executable.`);return i}let r=yield ie(e);return r&&r.length>0?r[0]:""})}m.which=re;function ie(e){return b(this,void 0,void 0,function*(){if(!e)throw new Error("parameter 'tool' is required");let t=[];if(u.IS_WINDOWS&&process.env.PATHEXT)for(let o of process.env.PATHEXT.split(g.delimiter))o&&t.push(o);if(u.isRooted(e)){let o=yield u.tryGetExecutablePath(e,t);return o?[o]:[]}if(e.includes(g.sep))return[];let r=[];if(process.env.PATH)for(let o of process.env.PATH.split(g.delimiter))o&&r.push(o);let i=[];for(let o of r){let s=yield u.tryGetExecutablePath(g.join(o,e),t);s&&i.push(s)}return i})}m.findInPath=ie;function st(e){let t=e.force==null?!0:e.force,r=Boolean(e.recursive);return{force:t,recursive:r}}function ne(e,t,r,i){return b(this,void 0,void 0,function*(){if(r>=255)return;r++,yield F(t);let o=yield u.readdir(e);for(let s of o){let a=`${e}/${s}`,f=`${t}/${s}`;(yield u.lstat(a)).isDirectory()?yield ne(a,f,r,i):yield oe(a,f,i)}yield u.chmod(t,(yield u.stat(e)).mode)})}function oe(e,t,r){return b(this,void 0,void 0,function*(){if((yield u.lstat(e)).isSymbolicLink()){try{yield u.lstat(t),yield u.unlink(t)}catch(o){o.code==="EPERM"&&(yield u.chmod(t,"0666"),yield u.unlink(t))}let i=yield u.readlink(e);yield u.symlink(i,t,u.IS_WINDOWS?"junction":null)}else(!(yield u.exists(t))||r)&&(yield u.copyFile(e,t))})}});var w=T(K()),ce=T(se()),ue=T(require("child_process"));function q(e){return e.message!==void 0}async function ae(){try{let e=await ct();e!==null&&q(e)&&w.setFailed(e.message)}catch(e){if(q(e)){w.setFailed(e.message);return}w.setFailed("Internal error")}}async function ct(){if(w.getInput("config")==="")return{message:"a flytectl config was not provided"};if(w.getInput("version")==="")return{message:"a version for register was not provided"};let r=w.getInput("project");if(r==="")return{message:"a project name was not provided"};let i=w.getInput("domain");if(i==="")return{message:"a domain name was not provided"};let o=w.getInput("proto");if(o==="")return{message:"a serialze proto url was not provided. like https://github.com/flyteorg/flytesnacks/releases/download/v0.2.89/flytesnacks-core.tgz"};let s=await ce.which("flytectl",!0);return s===""?{message:'flytectl is not installed; please add the "evalsocket/flytectl-setup-action" step to your job found at https://github.com/evalsocket/flytectl-setup-action'}:(ue.default.execSync(`${s} register file  ${o} --archive -p ${r} -d ${i}`),null)}ae();
//# sourceMappingURL=main.js.map
