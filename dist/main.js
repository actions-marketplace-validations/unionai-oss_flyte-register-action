var _e=Object.create;var P=Object.defineProperty;var ge=Object.getOwnPropertyDescriptor;var be=Object.getOwnPropertyNames;var we=Object.getPrototypeOf,Ee=Object.prototype.hasOwnProperty;var Se=e=>P(e,"__esModule",{value:!0});var S=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Oe=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of be(t))!Ee.call(e,i)&&i!=="default"&&P(e,i,{get:()=>t[i],enumerable:!(r=ge(t,i))||r.enumerable});return e},j=e=>Oe(Se(P(e!=null?_e(we(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var I=S($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.toCommandValue=void 0;function $e(e){return e==null?"":typeof e=="string"||e instanceof String?e:JSON.stringify(e)}$.toCommandValue=$e});var X=S(y=>{"use strict";var Ie=y&&y.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),Ce=y&&y.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Ne=y&&y.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Ie(t,e,r);return Ce(t,e),t};Object.defineProperty(y,"__esModule",{value:!0});y.issue=y.issueCommand=void 0;var Pe=Ne(require("os")),B=I();function H(e,t,r){let i=new k(e,t,r);process.stdout.write(i.toString()+Pe.EOL)}y.issueCommand=H;function je(e,t=""){H(e,{},t)}y.issue=je;var L="::",k=class{constructor(t,r,i){t||(t="missing.command"),this.command=t,this.properties=r,this.message=i}toString(){let t=L+this.command;if(this.properties&&Object.keys(this.properties).length>0){t+=" ";let r=!0;for(let i in this.properties)if(this.properties.hasOwnProperty(i)){let o=this.properties[i];o&&(r?r=!1:t+=",",t+=`${i}=${De(o)}`)}}return t+=`${L}${Te(this.message)}`,t}};function Te(e){return B.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A")}function De(e){return B.toCommandValue(e).replace(/%/g,"%25").replace(/\r/g,"%0D").replace(/\n/g,"%0A").replace(/:/g,"%3A").replace(/,/g,"%2C")}});var K=S(g=>{"use strict";var Fe=g&&g.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),xe=g&&g.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),z=g&&g.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Fe(t,e,r);return xe(t,e),t};Object.defineProperty(g,"__esModule",{value:!0});g.issueCommand=void 0;var J=z(require("fs")),Ae=z(require("os")),Ue=I();function qe(e,t){let r=process.env[`GITHUB_${e}`];if(!r)throw new Error(`Unable to find environment variable for file command ${e}`);if(!J.existsSync(r))throw new Error(`Missing file at path: ${r}`);J.appendFileSync(r,`${Ue.toCommandValue(t)}${Ae.EOL}`,{encoding:"utf8"})}g.issueCommand=qe});var ne=S(n=>{"use strict";var Me=n&&n.__createBinding||(Object.create?function(e,t,r,i){i===void 0&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){i===void 0&&(i=r),e[i]=t[r]}),We=n&&n.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),Y=n&&n.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.hasOwnProperty.call(e,r)&&Me(t,e,r);return We(t,e),t},Re=n&&n.__awaiter||function(e,t,r,i){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function d(l){try{p(i.next(l))}catch(h){a(h)}}function w(l){try{p(i.throw(l))}catch(h){a(h)}}function p(l){l.done?s(l.value):o(l.value).then(d,w)}p((i=i.apply(e,t||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0});n.getState=n.saveState=n.group=n.endGroup=n.startGroup=n.info=n.warning=n.error=n.debug=n.isDebug=n.setFailed=n.setCommandEcho=n.setOutput=n.getBooleanInput=n.getInput=n.addPath=n.setSecret=n.exportVariable=n.ExitCode=void 0;var _=X(),Z=K(),Ge=I(),C=Y(require("os")),Ve=Y(require("path")),Q;(function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure"})(Q=n.ExitCode||(n.ExitCode={}));function Be(e,t){let r=Ge.toCommandValue(t);if(process.env[e]=r,process.env.GITHUB_ENV||""){let o="_GitHubActionsFileCommandDelimeter_",s=`${e}<<${o}${C.EOL}${r}${C.EOL}${o}`;Z.issueCommand("ENV",s)}else _.issueCommand("set-env",{name:e},r)}n.exportVariable=Be;function He(e){_.issueCommand("add-mask",{},e)}n.setSecret=He;function Le(e){process.env.GITHUB_PATH||""?Z.issueCommand("PATH",e):_.issueCommand("add-path",{},e),process.env.PATH=`${e}${Ve.delimiter}${process.env.PATH}`}n.addPath=Le;function ee(e,t){let r=process.env[`INPUT_${e.replace(/ /g,"_").toUpperCase()}`]||"";if(t&&t.required&&!r)throw new Error(`Input required and not supplied: ${e}`);return t&&t.trimWhitespace===!1?r:r.trim()}n.getInput=ee;function ke(e,t){let r=["true","True","TRUE"],i=["false","False","FALSE"],o=ee(e,t);if(r.includes(o))return!0;if(i.includes(o))return!1;throw new TypeError(`Input does not meet YAML 1.2 "Core Schema" specification: ${e}
Support boolean input list: \`true | True | TRUE | false | False | FALSE\``)}n.getBooleanInput=ke;function Xe(e,t){process.stdout.write(C.EOL),_.issueCommand("set-output",{name:e},t)}n.setOutput=Xe;function ze(e){_.issue("echo",e?"on":"off")}n.setCommandEcho=ze;function Je(e){process.exitCode=Q.Failure,te(e)}n.setFailed=Je;function Ke(){return process.env.RUNNER_DEBUG==="1"}n.isDebug=Ke;function Ye(e){_.issueCommand("debug",{},e)}n.debug=Ye;function te(e){_.issue("error",e instanceof Error?e.toString():e)}n.error=te;function Ze(e){_.issue("warning",e instanceof Error?e.toString():e)}n.warning=Ze;function Qe(e){process.stdout.write(e+C.EOL)}n.info=Qe;function re(e){_.issue("group",e)}n.startGroup=re;function ie(){_.issue("endgroup")}n.endGroup=ie;function et(e,t){return Re(this,void 0,void 0,function*(){re(e);let r;try{r=yield t()}finally{ie()}return r})}n.group=et;function tt(e,t){_.issueCommand("save-state",{name:e},t)}n.saveState=tt;function rt(e){return process.env[`STATE_${e}`]||""}n.getState=rt});var ue=S(c=>{"use strict";var N=c&&c.__awaiter||function(e,t,r,i){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function d(l){try{p(i.next(l))}catch(h){a(h)}}function w(l){try{p(i.throw(l))}catch(h){a(h)}}function p(l){l.done?s(l.value):o(l.value).then(d,w)}p((i=i.apply(e,t||[])).next())})},oe=c&&c.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},m;Object.defineProperty(c,"__esModule",{value:!0});var it=require("assert"),nt=oe(require("fs")),O=oe(require("path"));m=nt.promises,c.chmod=m.chmod,c.copyFile=m.copyFile,c.lstat=m.lstat,c.mkdir=m.mkdir,c.readdir=m.readdir,c.readlink=m.readlink,c.rename=m.rename,c.rmdir=m.rmdir,c.stat=m.stat,c.symlink=m.symlink,c.unlink=m.unlink;c.IS_WINDOWS=process.platform==="win32";function ot(e){return N(this,void 0,void 0,function*(){try{yield c.stat(e)}catch(t){if(t.code==="ENOENT")return!1;throw t}return!0})}c.exists=ot;function st(e,t=!1){return N(this,void 0,void 0,function*(){return(t?yield c.stat(e):yield c.lstat(e)).isDirectory()})}c.isDirectory=st;function ct(e){if(e=at(e),!e)throw new Error('isRooted() parameter "p" cannot be empty');return c.IS_WINDOWS?e.startsWith("\\")||/^[A-Z]:/i.test(e):e.startsWith("/")}c.isRooted=ct;function se(e,t=1e3,r=1){return N(this,void 0,void 0,function*(){if(it.ok(e,"a path argument must be provided"),e=O.resolve(e),r>=t)return c.mkdir(e);try{yield c.mkdir(e);return}catch(i){switch(i.code){case"ENOENT":{yield se(O.dirname(e),t,r+1),yield c.mkdir(e);return}default:{let o;try{o=yield c.stat(e)}catch(s){throw i}if(!o.isDirectory())throw i}}}})}c.mkdirP=se;function ut(e,t){return N(this,void 0,void 0,function*(){let r;try{r=yield c.stat(e)}catch(o){o.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${e}': ${o}`)}if(r&&r.isFile()){if(c.IS_WINDOWS){let o=O.extname(e).toUpperCase();if(t.some(s=>s.toUpperCase()===o))return e}else if(ce(r))return e}let i=e;for(let o of t){e=i+o,r=void 0;try{r=yield c.stat(e)}catch(s){s.code!=="ENOENT"&&console.log(`Unexpected error attempting to determine if executable file exists '${e}': ${s}`)}if(r&&r.isFile()){if(c.IS_WINDOWS){try{let s=O.dirname(e),a=O.basename(e).toUpperCase();for(let d of yield c.readdir(s))if(a===d.toUpperCase()){e=O.join(s,d);break}}catch(s){console.log(`Unexpected error attempting to determine the actual case of the file '${e}': ${s}`)}return e}else if(ce(r))return e}}return""})}c.tryGetExecutablePath=ut;function at(e){return e=e||"",c.IS_WINDOWS?(e=e.replace(/\//g,"\\"),e.replace(/\\\\+/g,"\\")):e.replace(/\/\/+/g,"/")}function ce(e){return(e.mode&1)>0||(e.mode&8)>0&&e.gid===process.getgid()||(e.mode&64)>0&&e.uid===process.getuid()}});var he=S(v=>{"use strict";var E=v&&v.__awaiter||function(e,t,r,i){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function d(l){try{p(i.next(l))}catch(h){a(h)}}function w(l){try{p(i.throw(l))}catch(h){a(h)}}function p(l){l.done?s(l.value):o(l.value).then(d,w)}p((i=i.apply(e,t||[])).next())})},T=v&&v.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(v,"__esModule",{value:!0});var lt=T(require("child_process")),b=T(require("path")),ft=require("util"),u=T(ue()),D=ft.promisify(lt.exec);function dt(e,t,r={}){return E(this,void 0,void 0,function*(){let{force:i,recursive:o}=ht(r),s=(yield u.exists(t))?yield u.stat(t):null;if(s&&s.isFile()&&!i)return;let a=s&&s.isDirectory()?b.join(t,b.basename(e)):t;if(!(yield u.exists(e)))throw new Error(`no such file or directory: ${e}`);if((yield u.stat(e)).isDirectory())if(o)yield de(e,a,0,i);else throw new Error(`Failed to copy. ${e} is a directory, but tried to copy without recursive flag.`);else{if(b.relative(e,a)==="")throw new Error(`'${a}' and '${e}' are the same file`);yield pe(e,a,i)}})}v.cp=dt;function pt(e,t,r={}){return E(this,void 0,void 0,function*(){if(yield u.exists(t)){let i=!0;if((yield u.isDirectory(t))&&(t=b.join(t,b.basename(e)),i=yield u.exists(t)),i)if(r.force==null||r.force)yield ae(t);else throw new Error("Destination already exists")}yield F(b.dirname(t)),yield u.rename(e,t)})}v.mv=pt;function ae(e){return E(this,void 0,void 0,function*(){if(u.IS_WINDOWS){try{(yield u.isDirectory(e,!0))?yield D(`rd /s /q "${e}"`):yield D(`del /f /a "${e}"`)}catch(t){if(t.code!=="ENOENT")throw t}try{yield u.unlink(e)}catch(t){if(t.code!=="ENOENT")throw t}}else{let t=!1;try{t=yield u.isDirectory(e)}catch(r){if(r.code!=="ENOENT")throw r;return}t?yield D(`rm -rf "${e}"`):yield u.unlink(e)}})}v.rmRF=ae;function F(e){return E(this,void 0,void 0,function*(){yield u.mkdirP(e)})}v.mkdirP=F;function le(e,t){return E(this,void 0,void 0,function*(){if(!e)throw new Error("parameter 'tool' is required");if(t){let i=yield le(e,!1);if(!i)throw u.IS_WINDOWS?new Error(`Unable to locate executable file: ${e}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also verify the file has a valid extension for an executable file.`):new Error(`Unable to locate executable file: ${e}. Please verify either the file path exists or the file can be found within a directory specified by the PATH environment variable. Also check the file mode to verify the file is executable.`);return i}let r=yield fe(e);return r&&r.length>0?r[0]:""})}v.which=le;function fe(e){return E(this,void 0,void 0,function*(){if(!e)throw new Error("parameter 'tool' is required");let t=[];if(u.IS_WINDOWS&&process.env.PATHEXT)for(let o of process.env.PATHEXT.split(b.delimiter))o&&t.push(o);if(u.isRooted(e)){let o=yield u.tryGetExecutablePath(e,t);return o?[o]:[]}if(e.includes(b.sep))return[];let r=[];if(process.env.PATH)for(let o of process.env.PATH.split(b.delimiter))o&&r.push(o);let i=[];for(let o of r){let s=yield u.tryGetExecutablePath(b.join(o,e),t);s&&i.push(s)}return i})}v.findInPath=fe;function ht(e){let t=e.force==null?!0:e.force,r=Boolean(e.recursive);return{force:t,recursive:r}}function de(e,t,r,i){return E(this,void 0,void 0,function*(){if(r>=255)return;r++,yield F(t);let o=yield u.readdir(e);for(let s of o){let a=`${e}/${s}`,d=`${t}/${s}`;(yield u.lstat(a)).isDirectory()?yield de(a,d,r,i):yield pe(a,d,i)}yield u.chmod(t,(yield u.stat(e)).mode)})}function pe(e,t,r){return E(this,void 0,void 0,function*(){if((yield u.lstat(e)).isSymbolicLink()){try{yield u.lstat(t),yield u.unlink(t)}catch(o){o.code==="EPERM"&&(yield u.chmod(t,"0666"),yield u.unlink(t))}let i=yield u.readlink(e);yield u.symlink(i,t,u.IS_WINDOWS?"junction":null)}else(!(yield u.exists(t))||r)&&(yield u.copyFile(e,t))})}});var f=j(ne()),ye=j(he()),me=j(require("child_process"));function x(e){return e.message!==void 0}async function ve(){try{let e=await yt();e!==null&&x(e)&&f.setFailed(e.message)}catch(e){if(x(e)){f.setFailed(e.message);return}f.setFailed("Internal error")}}async function yt(){let e="files",t="",r=f.getInput("config");if(r.length>0&&(t="--config "+r),f.getInput("version")==="")return{message:"a version for register was not provided"};let o=f.getInput("project");if(o==="")return{message:"a project name was not provided"};let s=f.getInput("domain");if(s==="")return{message:"a domain name was not provided"};f.getInput("flytesnacks")==="true"&&(e="examples");let d="",w=f.getInput("k8ServiceAccount");w.length>0&&(d=w);let p="",l=f.getInput("k8ServiceAccount");l===""&&(p="--k8ServiceAccount "+l);let h="",A=f.getInput("outputLocationPrefix");A===""&&(h="--outputLocationPrefix "+A);let U="",q=f.getInput("sourceUploadPath");q.length>0&&(U="--sourceUploadPath "+q);let M="",W=f.getInput("archive");W==="true"&&(M="--archive");let R="";f.getInput("dryRun").length>0&&(R="--dryRun");let G="";f.getInput("continueOnError")===""&&(G="--continueOnError");let V=await ye.which("flytectl",!0);return V===""?{message:'flytectl is not installed; please add the "unionai/flytectl-setup-action" step to your job found at https://github.com/unionai/flytectl-setup-action'}:(me.default.execSync(`${V} register ${e} ${d} ${W} -p ${o} -d ${s} ${R} ${U} ${G} ${M} ${h} ${p} ${t}`),null)}ve();
//# sourceMappingURL=main.js.map
